---
layout: default
---

<article class="blog-post">
    {% if page.image %}
    <div class="blog-post__hero" style="background-image: url('{{ page.image | relative_url }}')">
        <div class="blog-post__hero-overlay"></div>
        <div class="container">
            <h1 class="blog-post__hero-title">{{ page.title }}</h1>
            {% if page.description %}
            <p class="blog-post__hero-description">{{ page.description }}</p>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <div class="container">
        <header class="blog-post__header">
            <nav class="breadcrumb">
                <a href="{{ '/blog/' | relative_url }}"><i class="breadcrumb__icon">ðŸ“š</i> Blog</a> &gt; {{ page.title }}
            </nav>
            
            <div class="blog-post__meta">
                <div class="blog-post__meta-left">
                    <time class="blog-post__date">{{ page.date | date: "%b %d, %Y" }}</time>
                    {% if page.readTime %}
                    <span class="blog-post__read-time">{{ page.readTime }}</span>
                    {% endif %}
                    
                    {% if page.author %}
                    <span class="blog-post__author">ðŸ‘¤ {{ page.author }}</span>
                    {% endif %}
                </div>
                
                <div class="blog-post__meta-right">
                    <button class="blog-post__share" title="Share this post">
                        <span>Share</span> <i class="blog-post__share-icon">ðŸ”—</i>
                    </button>
                </div>
            </div>
            
            {% if page.image == nil %}
            <h1 class="blog-post__title">{{ page.title }}</h1>
            
            {% if page.description %}
            <p class="blog-post__description">{{ page.description }}</p>
            {% endif %}
            {% endif %}
            
            {% if page.categories or page.tags %}
            <div class="blog-post__taxonomy">
                {% if page.categories.size > 0 %}
                <div class="blog-post__categories">
                    <span class="blog-post__taxonomy-label">Categories:</span>
                    {% for category in page.categories %}
                    <span class="tag tag--primary">{{ category }}</span>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if page.tags.size > 0 %}
                <div class="blog-post__tags">
                    <span class="blog-post__taxonomy-label">Tags:</span>
                    {% for tag in page.tags %}
                    <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endif %}
        </header>

        <div class="blog-post__wrapper">
            <!-- Table of Contents - Sidebar -->
            <aside class="blog-post__toc-sidebar" id="toc-sidebar">
                <div class="blog-post__toc">
                    <div class="blog-post__toc-header">
                        <span class="blog-post__toc-icon">ðŸ“‘</span>
                        Table of Contents
                    </div>
                    <div class="blog-post__toc-content">
                        <div id="toc"></div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <div class="blog-post__content">
                {{ content }}
            </div>
        </div>

        <footer class="blog-post__footer">
            <div class="blog-post__author-box">
                <div class="blog-post__author-avatar">
                    <img src="{{ '/src/assets/images/profile.jpg' | relative_url }}" alt="Author Avatar">
                </div>
                <div class="blog-post__author-info">
                    <h3 class="blog-post__author-name">{{ page.author | default: "HarryTien" }}</h3>
                    <p class="blog-post__author-bio">Network Engineer with a passion for security, technology, and coding. I love sharing my journey and learning experiences through this blog.</p>
                </div>
            </div>
            
            <div class="blog-post__navigation">
                {% if page.previous.url %}
                <a href="{{ page.previous.url | relative_url }}" class="blog-post__prev">
                    <span class="blog-post__nav-label">Previous Post</span>
                    <span class="blog-post__nav-title">{{ page.previous.title }}</span>
                </a>
                {% endif %}
                
                <a href="{{ '/blog/' | relative_url }}" class="blog-post__back">
                    <span class="blog-post__nav-label">Back to</span>
                    <span class="blog-post__nav-title">All Posts</span>
                </a>
                
                {% if page.next.url %}
                <a href="{{ page.next.url | relative_url }}" class="blog-post__next">
                    <span class="blog-post__nav-label">Next Post</span>
                    <span class="blog-post__nav-title">{{ page.next.title }}</span>
                </a>
                {% endif %}
            </div>
            
            <div class="blog-post__related">
                <h3 class="blog-post__related-title">Related Posts</h3>
                <div class="blog-post__related-posts">
                    {% assign maxRelated = 3 %}
                    {% assign minCommonTags = 1 %}
                    {% assign maxRelatedCounter = 0 %}
                
                    {% for post in site.posts %}
                        {% if post.url != page.url %}
                            {% assign sameTagCount = 0 %}
                            {% for tag in post.tags %}
                                {% if page.tags contains tag %}
                                    {% assign sameTagCount = sameTagCount | plus: 1 %}
                                {% endif %}
                            {% endfor %}
                            
                            {% if sameTagCount >= minCommonTags and maxRelatedCounter < maxRelated %}
                                <a href="{{ post.url | relative_url }}" class="blog-post__related-post">
                                    <span class="blog-post__related-post-title">{{ post.title }}</span>
                                    <span class="blog-post__related-post-date">{{ post.date | date: "%b %d, %Y" }}</span>
                                </a>
                                {% assign maxRelatedCounter = maxRelatedCounter | plus: 1 %}
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    
                    {% if maxRelatedCounter == 0 %}
                        {% for post in site.posts limit:3 %}
                            {% if post.url != page.url %}
                                <a href="{{ post.url | relative_url }}" class="blog-post__related-post">
                                    <span class="blog-post__related-post-title">{{ post.title }}</span>
                                    <span class="blog-post__related-post-date">{{ post.date | date: "%b %d, %Y" }}</span>
                                </a>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </footer>
    </div>
</article>

<script>
// Table of contents generator with sticky behavior
document.addEventListener('DOMContentLoaded', function() {
    const content = document.querySelector('.blog-post__content');
    const tocContainer = document.getElementById('toc');
    const tocSidebar = document.getElementById('toc-sidebar');
    
    if (!content || !tocContainer) return;
    
    const headings = content.querySelectorAll('h2, h3');
    if (headings.length === 0) {
        if (tocSidebar) tocSidebar.style.display = 'none';
        return;
    }
    
    const toc = document.createElement('ul');
    toc.className = 'blog-post__toc-list';
    
    headings.forEach((heading, index) => {
        // Add ID to the heading if it doesn't have one
        if (!heading.id) {
            heading.id = 'heading-' + index;
        }
        
        const listItem = document.createElement('li');
        listItem.className = 'blog-post__toc-item';
        if (heading.tagName === 'H3') {
            listItem.classList.add('blog-post__toc-item--sub');
        }
        
        const link = document.createElement('a');
        link.href = '#' + heading.id;
        link.textContent = heading.textContent;
        link.className = 'blog-post__toc-link';
        link.dataset.target = heading.id;
        
        listItem.appendChild(link);
        toc.appendChild(listItem);
    });
    
    tocContainer.appendChild(toc);

    // Highlight current section in TOC
    const tocLinks = document.querySelectorAll('.blog-post__toc-link');
    
    function updateActiveLink() {
        let currentSection = null;
        const scrollPos = window.scrollY + 100;

        headings.forEach(heading => {
            if (heading.offsetTop <= scrollPos) {
                currentSection = heading.id;
            }
        });

        tocLinks.forEach(link => {
            link.classList.remove('active');
            if (link.dataset.target === currentSection) {
                link.classList.add('active');
            }
        });
    }

    // Smooth scroll for TOC links
    tocLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const target = document.getElementById(targetId);
            if (target) {
                window.scrollTo({
                    top: target.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        });
    });

    // Update active link on scroll
    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
    
    // Share button functionality
    const shareButton = document.querySelector('.blog-post__share');
    if (shareButton) {
        shareButton.addEventListener('click', function() {
            if (navigator.share) {
                navigator.share({
                    title: document.title,
                    url: window.location.href
                });
            } else {
                // Fallback to copying the URL to clipboard
                navigator.clipboard.writeText(window.location.href)
                    .then(() => {
                        shareButton.innerText = 'URL Copied!';
                        setTimeout(() => {
                            shareButton.innerHTML = '<span>Share</span> <i class="blog-post__share-icon">ðŸ”—</i>';
                        }, 2000);
                    });
            }
        });
    }
});
</script>

<style>
/* Blog Post Wrapper - Two column layout */
.blog-post__wrapper {
    display: grid;
    grid-template-columns: 1fr 280px;
    gap: 3rem;
    align-items: start;
    margin-top: 2rem;
}

/* TOC Sidebar */
.blog-post__toc-sidebar {
    position: sticky;
    top: 100px;
    order: 2;
}

.blog-post__toc {
    background: var(--bg-secondary, #1a1a2e);
    border: 1px solid var(--border-color, #2a2a4a);
    border-radius: 12px;
    overflow: hidden;
}

.blog-post__toc-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 1.25rem;
    background: var(--bg-tertiary, #16162a);
    font-weight: 600;
    font-size: 0.9rem;
    border-bottom: 1px solid var(--border-color, #2a2a4a);
}

.blog-post__toc-icon {
    font-size: 1rem;
}

.blog-post__toc-content {
    padding: 1rem;
    max-height: calc(100vh - 200px);
    overflow-y: auto;
}

.blog-post__toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.blog-post__toc-item {
    margin-bottom: 0.25rem;
}

.blog-post__toc-item--sub {
    padding-left: 1rem;
}

.blog-post__toc-link {
    display: block;
    padding: 0.5rem 0.75rem;
    color: var(--text-secondary, #a0a0b0);
    font-size: 0.85rem;
    text-decoration: none;
    border-radius: 6px;
    transition: all 0.2s ease;
    border-left: 2px solid transparent;
}

.blog-post__toc-link:hover {
    color: var(--text-primary, #fff);
    background: var(--bg-hover, #252540);
}

.blog-post__toc-link.active {
    color: var(--accent-primary, #6366f1);
    background: rgba(99, 102, 241, 0.1);
    border-left-color: var(--accent-primary, #6366f1);
}

/* Main Content */
.blog-post__content {
    order: 1;
    min-width: 0;
}

/* Responsive */
@media (max-width: 1024px) {
    .blog-post__wrapper {
        grid-template-columns: 1fr;
        gap: 2rem;
    }

    .blog-post__toc-sidebar {
        position: relative;
        top: 0;
        order: -1;
    }

    .blog-post__toc-content {
        max-height: none;
    }
}

@media (max-width: 768px) {
    .blog-post__toc {
        border-radius: 8px;
    }

    .blog-post__toc-header {
        padding: 0.875rem 1rem;
    }

    .blog-post__toc-content {
        padding: 0.75rem;
    }
}
</style>
